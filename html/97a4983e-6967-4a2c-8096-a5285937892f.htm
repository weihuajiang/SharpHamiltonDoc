<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Instrument connection monitor</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="97a4983e-6967-4a2c-8096-a5285937892f" /><meta name="Description" content="In this section, the instrument connection status monitoring is dicussed" /><meta name="Microsoft.Help.ContentType" content="Samples" /><meta name="BrandingAware" content="true" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.3.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Hamilton STAR Integration SDK<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/f77747c6-38fb-4696-93d1-1e2b054feb13.htm" title="Hamilton STAR Integration SDK" tocid="roottoc">Hamilton STAR Integration SDK</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/6c6b6de5-0b90-46ca-8d1b-449023839654.htm" title="Tutorial" tocid="6c6b6de5-0b90-46ca-8d1b-449023839654">Tutorial</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/909e72b2-3ddd-40cc-b940-171f8ba27176.htm" title="How to" tocid="909e72b2-3ddd-40cc-b940-171f8ba27176">How to</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/97a4983e-6967-4a2c-8096-a5285937892f.htm" title="Instrument connection monitor" tocid="97a4983e-6967-4a2c-8096-a5285937892f">Instrument connection monitor</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/3b98aea8-667b-4fef-9a6f-ae2bc444bf5e.htm" title="Control Instrument" tocid="3b98aea8-667b-4fef-9a6f-ae2bc444bf5e">Control Instrument</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/ff42c383-4305-4ac2-b636-65ba5ea6c601.htm" title="Display 3D Layout" tocid="ff42c383-4305-4ac2-b636-65ba5ea6c601">Display 3D Layout</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/34b7045d-8cf9-476c-ae58-4e1c3c283ec7.htm" title="Error Recovery and Handling" tocid="34b7045d-8cf9-476c-ae58-4e1c3c283ec7">Error Recovery and Handling</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>Instrument connection monitor</h1></td></tr></table><span class="introStyle"></span> <div class="introduction"><p>In this section, the instrument connection status monitoring is dicussed</p></div><div class="collapsibleAreaRegion" id="Section1"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />monitoring instrument connection status</span></div><div id="ID1RBSection" class="collapsibleSection"><p>Before controling the instrument, the instrument should be online, so we have to monitor the status of connection. By listening to event of STARDiscover, you will be informed when connection status change</p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EACABAAA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EACABAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EACABAAA');return false;" title="Copy">Copy</a></div></div><div id="ID0EACABAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">STARDiscover discover = <span class="highlight-keyword">new</span> STARDiscover();
discover.OnConnect += Discover_OnConnect;
discover.OnDisconnect += Discover_OnDisconnect;
discover.OnReceive += Discover_OnReceive;
discover.Start();</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EACABAAA");</script><p>Before control the STARDiscover must be release to stop connection to instrument</p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EAAABAAA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAAABAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EAAABAAA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAAABAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">discover.Stop();
discover.OnConnect -= Discover_OnConnect;
discover.OnDisconnect -= Discover_OnDisconnect;
discover.OnReceive -= Discover_OnReceive;
discover.Dispose();
discover = <span class="highlight-keyword">null</span>;</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAAABAAA");</script></div></div></div><div id="pageFooter" class="pageFooter" /></body></html>